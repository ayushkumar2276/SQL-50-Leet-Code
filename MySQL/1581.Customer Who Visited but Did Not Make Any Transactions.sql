SELECT V.CUSTOMER_ID AS customer_id, COUNT(*) AS count_no_trans
FROM VISITS AS V
LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID
WHERE T.transaction_id IS NULL
GROUP BY V.CUSTOMER_ID;
